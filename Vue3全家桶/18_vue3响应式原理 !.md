https://2weirdo.github.io/2023/09/12/Vue%E7%9A%84%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/

## 1. è®¤è¯†å“åº”å¼é€»è¾‘ 

* å‡å¦‚ä½ æœ‰ä¸€ä¸ªå˜é‡m , ä½ çš„æŸä¸€æ®µä»£ç ä½¿ç”¨äº†å˜é‡m , å¦‚æœæŸä¸ªæ—¶åˆ»å˜é‡må‘ç”Ÿäº†æ”¹å˜, é‚£ä¹ˆè¿™æ®µä»£ç ä¹Ÿä¼šé‡æ–°æ‰§è¡Œ.
* ä½†å®é™…ä¸Šæ‰§è¡Œçš„ä»£ç ä¸­å¯èƒ½ä¸æ­¢ä¸€è¡Œä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä»£ç æ”¾åˆ°ä¸€ä¸ªå‡½æ•°ä¸­, äºæ˜¯å°±å˜æˆäº†, **ä½ æœ‰ä¸€ä¸ªå¯¹è±¡, ä½ çš„æŸä¸ªå‡½æ•°ä½¿ç”¨äº†å¯¹è±¡çš„æŸä¸ªå±æ€§, å¦‚æœæŸä¸ªæ—¶å€™è¿™ä¸ªå±æ€§å‘ç”Ÿæ”¹å˜, è¿™ä¸ªå‡½æ•°ä¹Ÿä¼šé‡æ–°æ‰§è¡Œ**

## 2. å“åº”å¼ä¾èµ–æ”¶é›†

### 2.1. å“åº”å¼å‡½æ•°çš„å®ç°watchFn

æˆ‘ä»¬ç°åœ¨å®ç°ä¸€ä¸ªå“åº”å¼å‡½æ•°

â—¼ ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿ

* ï°è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°è£…ä¸€ä¸ªæ–°çš„å‡½æ•°`watchFn`ï¼›
* ï°**å‡¡æ˜¯ä¼ å…¥åˆ°watchFnçš„å‡½æ•°ï¼Œå°±æ˜¯éœ€è¦å“åº”å¼çš„ï¼›**
* ï°å…¶ä»–é»˜è®¤å®šä¹‰çš„å‡½æ•°éƒ½æ˜¯ä¸éœ€è¦å“åº”å¼çš„ï¼›

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128126.png)

å¦‚å›¾, fooä»¥åŠbaréƒ½æ˜¯éœ€è¦å“åº”å¼çš„

æˆ‘ä»¬å°†è¿™äº›å‡½æ•°åœ¨å“åº”ä¹‹å‰å…ˆæ‰§è¡Œä¸€æ¬¡

å½“objçš„æŸä¸ªå±æ€§å‘ç”Ÿå˜åŒ–æ—¶, å°±ä¾æ¬¡æ‰§è¡ŒreactiveFnsä¸­çš„å‡½æ•°

ç›®å‰å½“ç„¶æ˜¯æä¸ºä¸å®Œå–„, å¾…åç»­ä¼˜åŒ–hhh



### 2.2. å“åº”å¼ä¾èµ–çš„æ”¶é›†__ç±»

â—¼ ç›®å‰æˆ‘ä»¬æ”¶é›†çš„ä¾èµ–æ˜¯æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­æ¥ä¿å­˜çš„ï¼Œä½†æ˜¯è¿™é‡Œä¼šå­˜åœ¨æ•°æ®ç®¡ç†çš„é—®é¢˜ï¼š

* ï° æˆ‘ä»¬åœ¨å®é™…å¼€å‘ä¸­**éœ€è¦ç›‘å¬å¾ˆå¤šå¯¹è±¡çš„å“åº”å¼ï¼›**
* ï° è¿™äº›å¯¹è±¡éœ€è¦ç›‘å¬çš„ä¸åªæ˜¯ä¸€ä¸ªå±æ€§ï¼Œå®ƒä»¬å¾ˆå¤šå±æ€§çš„å˜åŒ–ï¼Œéƒ½ä¼šæœ‰å¯¹åº”çš„å“åº”å¼å‡½æ•°ï¼›
* ï° æˆ‘ä»¬ä¸**å¯èƒ½åœ¨å…¨å±€ç»´æŠ¤ä¸€å¤§å †çš„æ•°ç»„æ¥ä¿å­˜è¿™äº›å“åº”å‡½æ•°ï¼›**

â—¼ æ‰€ä»¥æˆ‘ä»¬è¦**è®¾è®¡ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»ç”¨äºç®¡ç†æŸä¸€ä¸ªå¯¹è±¡çš„æŸä¸€ä¸ªå±æ€§çš„æ‰€æœ‰å“åº”å¼å‡½æ•°ï¼š**

* ï° ç›¸å½“äºæ›¿ä»£äº†åŸæ¥çš„ç®€å• reactiveFns çš„æ•°ç»„ï¼›

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128036.png)

è¿™ä¸ªç±»è®°ä½

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128173.png)

å½“æˆ‘ä»¬æŸä¸ªå±æ€§å‘ç”Ÿå˜åŒ–æ—¶, åªéœ€æ‰§è¡Œdep.notify()å°±è¡Œäº†, æ— éœ€ä¸€ä¸ªä¸€ä¸ªçš„éå†å‡½æ•°

è¿™ä¸ªobjå¯¹è±¡å°±å¯¹åº”Dependç±»æ‰€åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡

å½“ç„¶, è¿˜éœ€å¤§å¤§çš„ä¼˜åŒ–



ç°åœ¨æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹äº†ä¸€ä¸ªå±æ€§ä¹‹åéƒ½æ˜¯æ‰‹åŠ¨çš„å»è°ƒç”¨, è¿™æ ·å¤ªéº»çƒ¦äº†, æˆ‘ä»¬æƒ³è¦è®©å®ƒè‡ªåŠ¨å»è°ƒç”¨å“åº”å‡½æ•°,

å› æ­¤æˆ‘ä»¬è¦å»ç›‘å¬å±æ€§çš„å˜åŒ–



## 



## 3. Object.defineProperty()ç›‘å¬å±æ€§å˜åŒ–

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128117.png)

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128094.png)

å†è®°ä¸€éè¿™ä¸ªç±»

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128214.png)

æ³¨æ„çœ‹æ³¨é‡Š

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128429.png)

è¿™é‡Œåœ¨å±æ€§å˜åŒ–åå°±ä¸ç”¨æ‰‹åŠ¨ç»™å®ƒé€šçŸ¥äº†, è‡ªåŠ¨å“åº”å®ç°

ä¸è¿‡è¿™ç§æ”¶é›†æ–¹å¼å…¶å®æ˜¯é”™è¯¯çš„hhhhh



## 4. è‡ªåŠ¨æ”¶é›†ä¾èµ– ğŸ”¥

æˆ‘ä»¬ç°åœ¨å‘ç°äº†ä¸€ä¸ªé—®é¢˜ , obj å¯¹è±¡çš„ä¸¤ä¸ªå±æ€§éƒ½ä¾èµ–äº åŒä¸€ä¸ªdepå¯¹è±¡çš„reactiveFns,

è¿™æ ·å°±ä¼šé€ æˆæˆ‘ä»¬æ ¹æœ¬æ²¡åŠæ³•åŒºåˆ†å®ƒä»¬

å¯¹äºåŒä¸€ä¸ªå¯¹è±¡æ¥è¯´, æˆ‘ä»¬è¿˜æ˜¯ç»™å®ƒæ”¾åˆ°äº†åŒä¸€ä¸ªdepé‡Œé¢, è¿™ä¼šé€ æˆæ— æ³•å°†å®ƒçš„å±æ€§åŒºåˆ†

**å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ ?** 

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128467.png)

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128540.png)

æ¯”å¦‚æˆ‘ä»¬è¦è·å–objå¯¹è±¡çš„nameå±æ€§çš„ä¾èµ–

```javascript
const dep = objMap.get(obj).get(name);
dep.notifiy();
```



![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128693.png)

* depå¯¹è±¡æ•°æ®ç»“æ„çš„ç®¡ç†

* æ¯ä¸€ä¸ªå¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§éƒ½ä¼šå¯¹åº”ä¸€ä¸ªdepå¯¹è±¡
* åŒä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªå±æ€§çš„depå¯¹è±¡æ˜¯å­˜æ”¾ä¸€ä¸ªmapå¯¹è±¡ä¸­
* å¤šä¸ªå¯¹è±¡çš„mapå¯¹è±¡, ä¼šè¢«å­˜æ”¾åˆ°ä¸€ä¸ªobjMapçš„å¯¹è±¡ä¸­

* å½“æ‰§è¡Œgetå‡½æ•°, è‡ªåŠ¨çš„æ·»åŠ fnå‡½æ•°



```javascript
class Depend {
  constructor() {
    this.reactiveFns = []
  }

  addDepend(fn) {
    if (fn) {
      this.reactiveFns.push(fn)
    }
  }

  notify() {
    this.reactiveFns.forEach(fn => {
      fn()
    })
  }
}

const obj = {
  name: "why",
  age: 18
}

// è®¾ç½®ä¸€ä¸ªä¸“é—¨æ‰§è¡Œå“åº”å¼å‡½æ•°çš„ä¸€ä¸ªå‡½æ•°
let reactiveFn = null // 
function watchFn(fn) {
  reactiveFn = fn
  fn() // æ‰§è¡Œä¸‹æ–¹çš„getæ–¹æ³• , ä½¿å¾—é—´æ¥çš„æŠŠå‡½æ•°åŠ åˆ°ç‰¹å®šçš„depå¯¹è±¡ä¸Š
  //(å› ä¸ºå‡½æ•°ä¸­ä¼šæœ‰ä¸€äº›å¯¹è±¡ä¼šæœ‰ä¸€äº›å±æ€§)
  reactiveFn = null // ä½¿ç”¨å®Œåå†ç½®ä¸ºnull, ä¸ç„¶å¯èƒ½ä¼šé€ æˆå½±å“
}

// å°è£…ä¸€ä¸ªå‡½æ•°: è´Ÿè´£é€šè¿‡objçš„keyè·å–å¯¹åº”çš„Dependå¯¹è±¡
// æˆ‘ä»¬ç”¨ä¸€ä¸ªWeakMapå¯¹æ‰€æœ‰å¯¹è±¡è¿›è¡Œç®¡ç†, æˆ‘ä»¬ä¸éœ€è¦å¯¹é‡Œé¢è¿›è¡Œå¼ºå¼•ç”¨, 
// å¦‚æœæœ‰ä¸€å¤©objä¸ºnull,é‚£å°±æ— æ³•é”€æ¯äº†
const objMap = new WeakMap()


// è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯é€šè¿‡å¯¹è±¡çš„keyæ‰¾åˆ°å®ƒçš„depå¯¹è±¡
function getDepend(obj, key) {
  
  // 1.æ ¹æ®å¯¹è±¡obj, æ‰¾åˆ°å¯¹åº”çš„mapå¯¹è±¡
  let map = objMap.get(obj) // æ²¡æœ‰å°±newä¸€ä¸ª
  if (!map) {
    map = new Map()
    objMap.set(obj, map)
  }

  // 2.æ ¹æ®key, æ‰¾åˆ°å¯¹åº”çš„dependå¯¹è±¡
  let dep = map.get(key)
  if (!dep) {
    dep = new Depend()
    map.set(key, dep)
  }
  return dep
}

Object.keys(obj).forEach(key => {
  let value = obj[key]

  Object.defineProperty(obj, key, {
    set: function(newValue) {
      value = newValue
      // æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡çš„å±æ€§çš„depå¯¹è±¡
      const dep = getDepend(obj, key)
      dep.notify()  // å¯¹è¿™äº›
    },
    get: function() {
      // åœ¨å‡½æ•°ä¸­æ‹¿åˆ°obj å’Œ key å°±ä¼šè°ƒç”¨è¿™ä¸ªgetæ–¹æ³•
      // console.log("getå‡½æ•°ä¸­:", obj, key)
      // æ‰¾åˆ°å¯¹åº”çš„objå¯¹è±¡çš„keyå¯¹åº”çš„depå¯¹è±¡
      const dep = getDepend(obj, key) 
      // æ„å‘³ç€æˆ‘ä»¬åªä¼šåˆ›å»ºobjå¯¹è±¡çš„keyå±æ€§çš„depå¯¹è±¡
      dep.addDepend(reactiveFn) 
      // ç²¾é«“ : åœ¨è¿™ä¸ªdepå¯¹è±¡ä¸Šæ”¾å…¥è·Ÿç‰¹æœ‰å¯¹è±¡çš„ç‰¹æœ‰å±æ€§ç›¸å…³çš„å‡½æ•°,å³reactiveFn
      // depè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¿å­˜äº†è·Ÿè¿™ä¸ªç‰¹æœ‰å¯¹è±¡ç‰¹æœ‰å±æ€§ç›¸å…³çš„ä¸€äº›å‡½æ•°
      
      return value
    }
  })
})

watchFn(function foo() {
  console.log("foo function")
  console.log("foo:", obj.name)
  console.log("foo", obj.age)
})

watchFn(function bar() {
  console.log("bar function")
  console.log("bar:", obj.age + 10)
})
```

æ³¨æ„çœ‹æ³¨é‡Š !!!!!



ä½ ç”¨äº†æˆ‘çš„æ•°æ®, æˆ‘å°±æ”¶é›†ä½ çš„ä¾èµ–, ä½ æ²¡ç”¨, æˆ‘å°±ä¸æ”¶é›† ---



æˆ‘ä»¬è¿˜æœ‰å¯ä»¥ä¼˜åŒ–çš„ç‚¹ : 

å½“æˆ‘ä»¬æ‰§è¡Œä¸‹é¢è¿™æ®µä»£ç æ—¶

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128714.png)

ageå‘ç”Ÿå˜åŒ–æ—¶, å®ƒä¼šæ‰§è¡Œä¸¤æ¬¡å‡½æ•°

æˆ‘ä»¬å¯ä»¥è¿™æ ·æ“ä½œ

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128773.png)

æˆ‘ä»¬çš„reactiveFnsæ˜¯ä¸€ä¸ªSet, è¿™æ ·å®ƒå°±ä¸ä¼šæ·»åŠ ç›¸åŒçš„å‡½æ•°åˆ°è¿™é‡Œé¢å»

ç„¶åä¸‹æ–¹çš„pushæ”¹ä¸ºadd



è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹æ˜¯æˆ‘ä»¬å¯ä»¥ç»™![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128795.png)è¿™ä¸ªåœ°æ–¹æ¢ä¸ªå†™æ³•

æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å°†reactiveFnæ·»åŠ æ”¾åˆ°getä¸­ï¼Œå› ä¸ºå®ƒæ˜¯å±äºDepçš„è¡Œä¸º (ä¹Ÿå¯ä»¥ä¸æ¢, çœ‹è‡ªå·± )

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128933.png)

æˆ‘ä»¬ç›´æ¥åœ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•è‡ªåŠ¨è·å–æ”¶é›†çš„å‡½æ•°`depend()`

ç›¸å½“äºåˆ©ç”¨åˆ°è¿™ä¸ªè‡ªç”±å˜é‡`reactiveFn`

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128052.png)

ç„¶åç›´æ¥`dep.depen()`è°ƒç”¨å³å¯

ä¸è¿‡è¿™ä¸¤ç§å†™æ³•éƒ½å¯ä»¥ hhh





ä½†è¿™ä¸ªä»£ç è¿˜æœ‰ä¸è¶³, å…³äº**å¤šä¸ªå¯¹è±¡**, æˆ‘ä»¬å¦‚ä½•ç»™å®ƒæŒ¨ä¸ªæ¥è‡ªåŠ¨æ”¶é›†ä¾èµ–, å› ä¸ºæˆ‘ä»¬è¿™é‡Œæ˜¯å†™æ­»ç»™objå¯¹è±¡è‡ªåŠ¨æ”¶é›†ä¾èµ–çš„

å¦‚ä½•è§£å†³å‘¢? 

æ–¹æ³•å¦‚ä¸‹hhh ---- å¤šä¸ªå¯¹è±¡å“åº”å¼

## 5. å¤šä¸ªå¯¹è±¡å“åº”å¼

æˆ‘ä»¬åªéœ€è¦å°†ç›‘å¬å¯¹è±¡å±æ€§çš„è¿™ä¸€ä¸²ä»£ç å°è£…ä¸ºä¸€ä¸ªå‡½æ•°

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128077.png)

è¿™é‡Œæˆ‘ä»¬å°†è¿™ä¸€ä¸²ä»£ç å°è£…ä¸ºä¸€ä¸ªå‡½æ•°reactive, æˆ‘ä»¬åˆ›å»ºçš„å¯¹è±¡å°±å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’è¿›å», é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§å°±èƒ½è¢«ç›‘å¬åˆ°äº†, ç„¶åæˆ‘ä»¬**è¿”å›ä¸€ä¸ªè¢«ç›‘å¬çš„å¯¹è±¡**

æ³¨æ„ : éœ€è¦è¿”å›è¿™ä¸ªå¯¹è±¡å“ˆ, åˆ«æå¿˜äº†

ç„¶åæˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä½¿ç”¨è¿™ä¸ªå‡½æ•°, é‚£ä¹ˆå¯¹è±¡çš„æ‰€æœ‰å±æ€§å°±èƒ½è¢«ç›‘å¬åˆ°äº†

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128137.png)

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128189.png)



ä»¥ä¸Šéƒ½æ˜¯vue2å“åº”å¼åŸç†(ä¹Ÿå°±æ˜¯defineProperty), æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨vue3å¯¹ä»£ç è¿›è¡Œé‡æ„

ç‰¹åˆ«easy

## 6. vue3__ç›‘å¬å¯¹è±¡__proxy

æˆ‘ä»¬ç›´æ¥å°†

Object.defineProperty

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128077.png)

è¿™éƒ¨åˆ†ä»£ç æ”¹æˆ

proxy

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128226.png)

åœ¨æˆ‘ä»¬è°ƒç”¨äº†Proxyçš„getæ•è·å™¨æ—¶, æ”¶é›†ä¾èµ–

å› ä¸ºå¦‚æœä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨äº†æŸä¸ªå¯¹è±¡çš„keyï¼Œé‚£ä¹ˆå®ƒåº”è¯¥è¢«æ”¶é›†ä¾èµ–ï¼›

è¿™éƒ¨åˆ†ä»£ç å³å¯

éƒ½æ˜¯å­¦è¿‡çš„ä¸œè¥¿ , å¿˜äº†å°±ç¿»ç¿»å‰é¢çš„ç¬”è®° 





## 7. å®Œæ•´å“åº”å¼ä»£ç 

å®Œæ•´å“åº”å¼ä»£ç 

```javascript
class Depend {
  constructor() {
    this.reactiveFns = new Set()
  }

  // addDepend(fn) {
  //   if (fn) {
  //     this.reactiveFns.add(fn)
  //   }
  // }

  depend() {
    if (reactiveFn) {
      this.reactiveFns.add(reactiveFn)
    }
  }

  notify() {
    this.reactiveFns.forEach(fn => {
      fn()
    })
  }
}

let reactiveFn = null
function watchFn(fn) {
  reactiveFn = fn
  fn()
  reactiveFn = null
}

const objMap = new WeakMap()
function getDepend(obj, key) {
  // 1.æ ¹æ®å¯¹è±¡obj, æ‰¾åˆ°å¯¹åº”çš„mapå¯¹è±¡
  let map = objMap.get(obj)
  if (!map) {
    map = new Map()
    objMap.set(obj, map)
  }

  // 2.æ ¹æ®key, æ‰¾åˆ°å¯¹åº”çš„dependå¯¹è±¡
  let dep = map.get(key)
  if (!dep) {
    dep = new Depend()
    map.set(key, dep)
  }
  return dep
}

function reactive(obj) {
  const objProxy = new Proxy(obj, {
    set: function(target, key, newValue, receiver) {
      // target[key] = newValue
      Reflect.set(target, key, newValue, receiver)
      const dep = getDepend(target, key)
      dep.notify()
    },
    get: function(target, key, receiver) {
      const dep = getDepend(target, key)
      dep.depend()
      return Reflect.get(target, key, receiver)
    }
  })
  return objProxy 
}
```



ä¸šåŠ¡ä»£ç 

```javascript
const obj = reactive({
  name: "why",
  age: 18,
  address: "å¹¿å·å¸‚"
})

watchFn(function() {
  console.log(obj.name)
  console.log(obj.age)
  console.log(obj.age)
})

// ä¿®æ”¹name
console.log("--------------")
// obj.name = "kobe"
obj.age = 20
// obj.address = "ä¸Šæµ·å¸‚"


console.log("=============== user =================")
const user = reactive({
  nickname: "abc",
  level: 100
})

watchFn(function() {
  console.log("nickname:", user.nickname)
  console.log("level:", user.level)
})

user.nickname = "cba"
```



æ‰§è¡Œç»“æœ

![img](https://weirdo-blog.oss-cn-chengdu.aliyuncs.com/blog/202310261128361.png)





æ€»ç»“ : 

* Vue3ä¸»è¦æ˜¯é€šè¿‡Proxyæ¥ç›‘å¬æ•°æ®çš„å˜åŒ–ä»¥åŠæ”¶é›†ç›¸å…³çš„ä¾èµ–çš„ï¼›
* ue2ä¸­é€šè¿‡æˆ‘ä»¬å‰é¢å­¦ä¹ è¿‡çš„Object.defineProertyçš„æ–¹å¼æ¥å®ç°å¯¹è±¡å±æ€§çš„ç›‘å¬ï¼›